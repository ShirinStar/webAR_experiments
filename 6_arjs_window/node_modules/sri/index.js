const crypto = require('crypto');

const algorithm = 'sha384';

function getSRIString(data) {
  return getIntegrity(algorithm, getSRIHash(data));
}

function getIntegrity(algorithm, hash) {
  return `${algorithm}-${hash}`;
}

function getSRIHash(data) {
  return crypto
    .createHash(algorithm)
    .update(data, 'utf8')
    .digest('base64');
}

module.exports = { getSRIString };
